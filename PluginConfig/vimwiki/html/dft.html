<script type="text/javascript" src="scripts/shCore.js"></script>
<link type="text/css" rel="stylesheet" href="styles/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>

<script type="text/javascript" src="scripts/shBrushverilog.js"></script>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>dft</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>

<pre class="brush:c++">
#include &lt;stdio.h&gt;
#include &lt;math.h&gt;

//-------------------------------------------------------------------------
//function		:   dft
//description	:   
//input			:   x[]: The real part of the data before conversion 
//                  y[]: The imaginary part of the data before conversion
//                  a[]: The real part of the data after conversion 
//                  b[]: The imaginary part of the data after conversion 
//                  n: data length
//                  sign: type. sign=1, dft; sign=-1, idft
//return		:    
//others		:    
//------------------------------------------------------------------------- 
void dft(double x[], double y[], double a[], double b[], int n, int sign)
{
    int i, k ;
    double c, d, q, w, s ;

    q = 6.28318530718 / n ;

    for( k = 0; k &lt; n; k++ )
    {
        w = k * q ;
        a[k] = b[k] = 0.0 ;

        for( i = 0; i &lt; n; i++ )
        {
            d = i *w ;
            c = cos(d) ;
            s = sin(d) * sign ;
            a[k] += c * x[i] + s * y[i] ;
            b[k] += c * y[i] - s * y[i] ;
        }

        if(sign == -1)
        {
            c = 1.0 /n ;
            for( k = 0; k &lt; n; k++ )
            {
                a[k] = c * a[k] ;
                b[k] = c * b[k] ; 
            }
        }
    }
}


int main(int argc, char *argv[])
{
    int i, j, n ;
    double a1, a2, c, c1, c2, d1, d2, q1, q2, w, w1, w2 ;
    double x[32], y[32], a[32], b[32] ;

    n = 32 ;
    a1 = 0.9 ;
    a2 = 0.3 ;
    x[0] = 1.0 ;
    y[0] = 0.0 ;

    for( i = 1; i &lt; n; i++ )
    {
        x[i] = a1 * x[i-1] - a2 * y[i-1] ;
        y[i] = a2 * x[i-1] + a1 * y[i-1] ;
    }
    printf("\n Original Sequence\n") ;

    for( i = 0; i &lt; n/2; i++ )
    {
        for( j = 0; j &lt; 2; j++ )
        {
            printf("    %10.7f + J %10.7f", x[2*i+j], y[2*i+j]) ;
        }
        printf("\n") ;
    }
    q1 = x[n - 1] ;
    q2 = y[n - 1] ;

    dft(x, y, a, b, n, 1) ;
    printf("\n Discrete Fourier Transform\n") ;
    for( i = 0; i &lt; n/2; i++ )
    {
        for( j = 0; j &lt; 2; j++ )
        {
            printf("    %10.7f + J %10.7f", a[2*i+j], b[2*i+j]) ;
        }
        printf("\n") ;
    }

    for( i = 0; i &lt; n; i++ )
    {
        w = 6.28318530718/n * i ;
        w1 = cos(w) ;
        w2 = -sin(w) ;
        c1 = 1.0 - a1 * w1 + a2 * w2 ;
        c2 = a1 * w2 + a2 * w1 ;
        c = c1 * c2 + c2 * c2 ;
        d1 = 1.0 - a1 * q1 + a2 * q2 ;
        d2 = a1 * q2 + a2 * q1 ;
        x[i] = (c1 * d1 + c2 * d2) / c ;
        y[i] = (c2 * d1 - c1 * d2) / c ;
    }

    printf("\n Theoretical Discrete Fourier Transform\n" ) ;
    for( i = 0; i &lt; n/2; i++ )
    {
        for( j = 0; j &lt; 2; j++ )
        {
            printf("    %10.7f + J %10.7f", x[2*i+j], y[2*i+j]) ;
        }
        printf("\n") ;
    }
    dft(a, b, x, y, n, -1) ;

    printf("\n Inverse Discrete Fourier Transform\n" ) ;
    for( i = 0; i &lt; n/2; i++ )
    {
        for( j = 0; j &lt; 2; j++ )
        {
            printf("    %10.7f + J %10.7f", x[2*i+j], y[2*i+j]) ;
        }
        printf("\n") ;
    }
    return 0 ;
}
</pre>

</body>
</html>

